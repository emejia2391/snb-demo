{% extends 'base.html' %}
{% block content %}
<style>
  /* Estilos del select de Área social (y cualquier select con clase .select) */
  .select{
    background:#0f3a2d;     /* verde oscuro del tema */
    color:#e9fff5;
    border:1px solid rgba(255,255,255,.1);
  }
  .select:focus{
    background:#0f3a2d;
    color:#e9fff5;
    outline:none;
    box-shadow:0 0 0 2px rgba(22,106,67,.35);
  }
  /* Fondo del menú desplegable (lista de opciones) */
  .select option{
    background:#14532d;     /* verde */
    color:#ffffff;
  }
  /* Opción resaltada/seleccionada al navegar */
  .select option:hover,
  .select option:checked{
    background:#166a43;     /* un poco más claro */
    color:#ffffff;
  }
  /* Opciones deshabilitadas */
  .select option:disabled{
    background:#0c2a22;
    color:#8fb2a2;
  }

  /* Caja de precio (arriba a la derecha) */
  .price-box{position:absolute; top:18px; right:20px; padding:10px 14px; color:#fff; font-weight:600;}
</style>

<section class="card" style="position:relative;">
  <div id="priceInfo" class="price-box"></div>
  <h2 class="form-title">Nueva Reservación</h2>
  <form method="POST" class="form-grid" id="reservaForm">
    <div class="form-row">
      <label class="lbl">Área social</label>
      <select name="id_area" id="id_area" class="select" required>
        {% for a in areas %}
          <option value="{{ a.id_area }}" {% if selected_id_area and a.id_area == selected_id_area %}selected{% endif %}>{{ a.nombre }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="form-row">
      <label class="lbl">Fecha</label>
      <input type="date" name="fecha" id="fecha" class="input" required>
      <small id="fechaHelp" class="muted"></small>
    </div>

    <div class="form-row">
      <label class="lbl">Hora de inicio</label>
      <div id="horasDisponibles" class="horas-grid"></div>
      <input type="hidden" name="hora_inicio" id="hora_inicio">
      <div class="hora-fin-block">
        <label class="lbl" style="margin-top:8px;display:block;">Hora fin</label>
        <div id="horaFinWrap" class="horas-grid"></div>
      </div>
    </div>

    
<div class="form-row">
  <label class="lbl">Usuario</label>
  <div class="user-inline">
    <div id="usuarioDisplay"><strong>{{ user.nombre }} {{ user.apellido }}</strong></div>
    <input type="hidden" name="id_usuario" id="id_usuario" value="{{ user.id_usuario }}">
    {% if (user and user.id_rol != 2) %}
<button type="button" id="btnCambiarUsuario" class="btn btn-small btn-ghost" title="Cambiar Residente" class="btn btn-small">
      <span class="icon" aria-hidden="true" style="display:inline-flex;align-items:center;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Lupa">
          <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/>
          <line x1="16.65" y1="16.65" x2="22" y2="22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </span>
      <span>Buscar Residente</span></button>
{% endif %}
  </div>
</div>


    <div class="form-actions">
      <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancelar</a>
      <button type="submit" class="btn btn-accent">Guardar</button>
    </div>
  </form>
</section>

<div id="modalUsuarios" class="modal" hidden>
  <div class="modal-content">
    <div class="modal-head">
      <h3>Buscar residente</h3>
      <button id="cerrarModal" class="btn-icon">✕</button>
    </div>
    <input type="text" id="filtro" class="input" placeholder="Nombre o apellido..." >
    <div id="resultados" class="resultados"></div>
  </div>
</div>

<script defer src="{{ url_for('static', filename='reservas.js') }}"></script>
{% endblock %}
